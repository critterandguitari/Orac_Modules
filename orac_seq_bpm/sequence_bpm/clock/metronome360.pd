#N canvas 135 60 1781 984 10;
#X obj 321 69 inlet start/stop;
#X obj 320 110 s \$0-strtStop;
#X text 38 307 Arg 1: internal bpm on or off;
#X text 328 44 start stop;
#X text 1086 532 multiply 24 ppq midi clock by 15 to get 360 ppq;
#X text 37 159 This metronome outputs 360 ticks per beat numbered 0-359.
If Ableton LINK session or MIDI clock is present it will latch onto
those \, otherwise it uses internal clock. It uses link object to also
generate the internal clock. It takes tempo and start/stop input and
outputs ticks 0-359;
#X text 37 253 It also outputs the tempo and clock source useful for
display purposes.;
#X text 87 758 the clockfix object ensures there are always 360 ticks
numbered 0-359. This is necessary when tempos increases to the point
where a tick is shorter than a dsp cycle in Pd (otherwise some numbers
get skipped). also necessary for lower resolution clock sources like
midi clock. it doesn't interpolate \, but does ensure we always get
0-359 no matter what goes in.;
#X floatatom 781 294 5 0 0 1 tempo - -;
#X obj 553 445 i;
#X obj 500 76 moses 10;
#X obj 1001 52 midirealtimein;
#X text 1317 93 MIDI 248 = clock \; 250 = start \; 251 = continue.
252 = stop;
#X obj 1001 103 sel 248 250 251 252 254, f 38;
#X obj 500 13 inlet tempo;
#X obj 553 327 spigot 0;
#X obj 606 297 r \$0-strtStop;
#X obj 1086 556 r link-session-present;
#X obj 584 936 outlet beat-clock;
#X obj 823 937 outlet Tempo;
#N canvas 303 750 292 294 mstobpm 0;
#X obj 46 14 inlet;
#X obj 47 248 outlet;
#X obj 46 108 t b b;
#X obj 46 79 sel 0;
#X text 87 47 time 16th notes;
#X obj 46 145 timer;
#X obj 46 46 % 12;
#X obj 46 182 expr 30000 / $f1;
#X connect 0 0 6 0;
#X connect 2 0 5 0;
#X connect 2 1 5 1;
#X connect 3 0 2 0;
#X connect 5 0 7 0;
#X connect 6 0 3 0;
#X connect 7 0 1 0;
#X restore 873 630 pd mstobpm;
#X obj 919 682 r midi-clock-present;
#X obj 873 710 spigot 0;
#N canvas 465 318 729 612 average-bpm 0;
#X obj 98 20 inlet;
#X obj 360 226 + 1;
#X obj 251 189 t a b;
#X obj 330 224 f 0;
#X obj 48 185 array sum \$0-bpm-mean;
#X obj 98 42 t b a;
#X obj 48 229 + 0.499999;
#X obj 48 251 i;
#X obj 48 273 outlet;
#X obj 284 11 loadbang;
#X msg 284 33 const 120;
#X obj 251 280 array set \$0-bpm-mean 5;
#X obj 48 207 / 5;
#X obj 330 246 % 5;
#X obj 284 58 array define -k \$0-bpm-mean 5;
#A 0 120 120 120 120 120;
#X floatatom 230 131 5 0 0 0 - - -;
#X connect 0 0 5 0;
#X connect 1 0 3 1;
#X connect 2 0 11 0;
#X connect 2 1 3 0;
#X connect 3 0 1 0;
#X connect 3 0 13 0;
#X connect 4 0 12 0;
#X connect 5 0 4 0;
#X connect 5 1 2 0;
#X connect 5 1 15 0;
#X connect 6 0 7 0;
#X connect 7 0 8 0;
#X connect 9 0 10 0;
#X connect 10 0 14 0;
#X connect 12 0 6 0;
#X connect 13 0 11 1;
#X restore 873 653 pd average-bpm;
#X obj 1173 319 delay 1000;
#X msg 1115 321 1;
#X obj 1001 256 t b b b b, f 25;
#X msg 1173 294 stop;
#X msg 1173 343 0;
#X obj 1115 454 s midi-clock-present;
#X obj 1145 378 + 1;
#X obj 1115 378 f 0;
#X obj 1115 400 % 2;
#X obj 1001 415 f;
#X obj 1059 414 + 1;
#X obj 1001 437 t f f;
#X obj 1001 482 % 24;
#X obj 1001 380 spigot 0;
#X obj 1033 536 * 15;
#X obj 1033 586 i;
#X obj 1033 608 spigot 0;
#X obj 1086 583 ==;
#X obj 634 364 ==;
#X obj 634 342 r midi-clock-present;
#X obj 1158 129 s midi-stop;
#X obj 1073 199 s midi-start;
#X obj 1106 158 s midi-cont;
#X obj 1304 815 outlet Clock-source;
#X obj 553 389 spigot 1, f 12;
#X obj 556 487 t f b;
#X obj 603 489 r link-session-present;
#X obj 585 565 sel 0 1, f 23;
#X obj 585 697 s \$0-clock-source;
#X obj 1305 727 r \$0-clock-source;
#X obj 585 521 f 0;
#X obj 584 814 clockfix;
#X obj 1065 680 s \$0-clock-source;
#X obj 1033 630 t f b;
#X msg 1065 657 2;
#X msg 702 643 3;
#X obj 1304 768 change -1;
#X obj 820 764 change -1;
#X obj 553 182 f;
#X obj 581 86 r midi-clock-present;
#X obj 607 111 r link-session-present;
#X obj 581 138 sel 0;
#N canvas 341 50 899 726 LINK 0;
#X msg 355 126 tempo \$1;
#X msg 144 127 resolution \$1;
#X msg 247 147 reset \$1 \$2;
#X obj 247 126 pack f f;
#X floatatom 378 246 5 0 0 1 tempo - -;
#X obj 59 105 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1 1
1;
#X floatatom 355 107 5 0 0 2 tempo - -;
#X floatatom 292 107 5 0 0 2 quantum - -;
#X floatatom 247 107 5 0 0 2 beat - -;
#X floatatom 144 107 5 0 0 2 resolution - -;
#X msg 59 125 connect \$1;
#X floatatom 510 231 5 0 0 0 - - -;
#X obj 510 209 r #abl_link_num_peers;
#X obj 32 67 delay 100;
#X obj 285 31 inlet;
#X obj 388 273 i;
#X obj 388 295 outlet;
#X obj 510 261 > 0;
#X obj 510 283 s link-session-present;
#X obj 213 590 wrap, f 9;
#X obj 210 624 outlet;
#X obj 257 298 f 0;
#X obj 213 558 spigot 1;
#X msg 255 438 0;
#X msg 306 435 1;
#X obj 323 360 f 0;
#X obj 272 361 >;
#X obj 251 392 sel 1;
#X obj 312 384 > 0;
#X obj 307 413 sel 1;
#X obj 254 417 t b b;
#X obj 246 320 t f f;
#X obj 246 263 t f b f f;
#X text 378 380 sometimes link goes in reverse. just supress the output
when that happens \, wait till it increses past where it started decreasing.
, f 30;
#X obj 279 474 spigot 1;
#X obj 183 200 abl_link~ 1 0 1 134;
#X obj 60 12 r loadbang-\$1;
#X floatatom 90 342 50 0 0 0 - - -;
#X connect 0 0 35 0;
#X connect 1 0 35 0;
#X connect 2 0 35 0;
#X connect 3 0 2 0;
#X connect 4 0 15 0;
#X connect 5 0 10 0;
#X connect 6 0 0 0;
#X connect 7 0 3 1;
#X connect 8 0 3 0;
#X connect 9 0 1 0;
#X connect 10 0 35 0;
#X connect 11 0 17 0;
#X connect 12 0 11 0;
#X connect 13 0 5 0;
#X connect 14 0 6 0;
#X connect 15 0 16 0;
#X connect 17 0 18 0;
#X connect 19 0 20 0;
#X connect 21 0 31 0;
#X connect 22 0 19 0;
#X connect 23 0 22 1;
#X connect 23 0 34 1;
#X connect 24 0 22 1;
#X connect 24 0 34 1;
#X connect 25 0 28 1;
#X connect 26 0 27 0;
#X connect 27 0 30 0;
#X connect 28 0 29 0;
#X connect 29 0 24 0;
#X connect 30 0 23 0;
#X connect 30 1 34 0;
#X connect 31 0 26 0;
#X connect 31 1 25 1;
#X connect 32 0 21 1;
#X connect 32 1 21 0;
#X connect 32 2 26 1;
#X connect 32 3 28 0;
#X connect 34 0 25 0;
#X connect 35 1 22 0;
#X connect 35 2 32 0;
#X connect 35 2 37 0;
#X connect 35 3 4 0;
#X connect 36 0 13 0;
#X restore 553 265 pd LINK - - - - - - - - - - - - -;
#X msg 592 631 1;
#X obj 1001 504 t f f;
#X text 1464 735 1 = internal bpm(set by og knob);
#X text 1464 795 4 = Hidden default bpm(off);
#X obj 781 464 spigot 1, f 12;
#X obj 1001 125 t b b;
#X text 1464 755 2 = MIDI BPM;
#X text 1464 775 3 = LINK BPM;
#X obj 493 652 t f f;
#X obj 478 722 s pre-cf;
#X obj 550 416 * 360;
#X obj 1046 168 t b b;
#X text 1163 200 reset clock on midi start;
#X msg 1037 202 0;
#X connect 0 0 1 0;
#X connect 8 0 71 0;
#X connect 9 0 49 0;
#X connect 10 1 62 0;
#X connect 11 0 13 0;
#X connect 13 0 72 0;
#X connect 13 1 78 0;
#X connect 13 2 46 0;
#X connect 13 3 44 0;
#X connect 14 0 10 0;
#X connect 15 0 48 0;
#X connect 16 0 15 1;
#X connect 17 0 41 0;
#X connect 20 0 23 0;
#X connect 21 0 22 1;
#X connect 22 0 61 0;
#X connect 23 0 22 0;
#X connect 24 0 28 0;
#X connect 25 0 31 0;
#X connect 26 0 37 0;
#X connect 26 1 24 0;
#X connect 26 2 25 0;
#X connect 26 3 27 0;
#X connect 27 0 24 0;
#X connect 28 0 31 0;
#X connect 30 0 31 1;
#X connect 31 0 30 0;
#X connect 31 0 32 0;
#X connect 32 0 37 1;
#X connect 32 0 29 0;
#X connect 33 0 35 0;
#X connect 34 0 33 1;
#X connect 35 0 36 0;
#X connect 35 1 34 0;
#X connect 36 0 68 0;
#X connect 37 0 33 0;
#X connect 38 0 39 0;
#X connect 39 0 40 0;
#X connect 40 0 57 0;
#X connect 41 0 40 1;
#X connect 42 0 48 1;
#X connect 42 0 71 1;
#X connect 43 0 42 0;
#X connect 48 0 77 0;
#X connect 49 0 75 0;
#X connect 49 1 54 0;
#X connect 50 0 54 1;
#X connect 51 0 67 0;
#X connect 51 1 59 0;
#X connect 53 0 60 0;
#X connect 54 0 51 0;
#X connect 55 0 18 0;
#X connect 57 0 55 0;
#X connect 57 1 58 0;
#X connect 58 0 56 0;
#X connect 59 0 52 0;
#X connect 60 0 47 0;
#X connect 61 0 19 0;
#X connect 62 0 66 0;
#X connect 63 0 65 0;
#X connect 64 0 65 0;
#X connect 65 0 62 0;
#X connect 66 0 15 0;
#X connect 66 1 8 0;
#X connect 67 0 52 0;
#X connect 68 0 20 0;
#X connect 68 1 38 0;
#X connect 71 0 61 0;
#X connect 72 0 26 0;
#X connect 75 0 55 0;
#X connect 75 1 76 0;
#X connect 77 0 9 0;
#X connect 78 0 80 0;
#X connect 78 1 45 0;
#X connect 80 0 33 1;
